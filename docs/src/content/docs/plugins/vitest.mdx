---
title: '@onerepo/plugin-vitest'
sidebar:
  label: Vitest
description: Official Vitest plugin for the oneRepo JavaScript and TypeScript monorepo toolchain.
meta:
  version: 0.6.0
  stability: stable
---

import { TabItem } from '@astrojs/starlight/components';
import Tabs from '../../../components/Tabs.astro';

## Installation

<Tabs group="pkgmanager">
  <TabItem label="npm">

    ```sh title="Install via npm"
    npm install --save-dev @onerepo/plugin-vitest
    ```

  </TabItem>
  <TabItem label="yarn">

    ```sh title="Install via Yarn"
    yarn add --dev @onerepo/plugin-vitest
    ```

  </TabItem>
  <TabItem label="pnpm">

    ```sh title="Install via pnpm"
    pnpm install --save-dev @onerepo/plugin-vitest
    ```

  </TabItem>
</Tabs>

{/* start-install-typedoc */}
{/* @generated SignedSource<<12c4855cea236c5e298a4cfa5ebe6fe2>> */}

### vitest()

```ts
function vitest(opts): PluginObject;
```

Include the `vitest` plugin in your oneRepo plugin setup:

```js title="onerepo.config.ts" {1,4}
import { vitest } from '@onerepo/plugin-vitest';

export default {
	plugins: [vitest()],
};
```

#### Parameters

| Parameter | Type                  |
| :-------- | :-------------------- |
| `opts`    | [`Options`](#options) |

### Options

```ts
type Options: {
  config: string;
  name: string | string[];
};
```

Options for configuring the Vitest oneRepo plugin.

```js title="onerepo.config.js"
export default {
	plugins: [
		vitest({
			name: ['test'],
		}),
	],
};
```

#### Type declaration

##### config?

```ts
config?: string;
```

Specify the main Jest configuration file, if different from `<repo>/vitest.config.js`. This can be relative to the repository root.

```js title="onerepo.config.js"
export default {
	plugins: [
		vitest({
			config: 'configs/vitest.config.js'
		}),
	],
});
```

##### name?

```ts
name?: string | string[];
```

- **Default:** `'vitest'`

Rename the default command name. This configuration is recommended, but not provided, to avoid potential conflicts with other commands.

```js title="onerepo.config.js"
export default {
	plugins: [
		vitest({
			name: ['test', 'vitest']
		}),
	],
});
```

{/* end-install-typedoc */}

## Commands

{/* start-auto-generated-from-cli-vitest */}
{/* @generated SignedSource<<595d46f456184a9d2b9e5ea531e788ab>> */}

### `one test`

Aliases: `one vitest`

Run unit tests using Vitest

```sh
one test [options] -- [passthrough]
one test [options]
```

This test commad will automatically attempt to run only the test files related to the changes in your git branch. By passing specific filepaths as extra passthrough arguments after two dashes (`--`), you can further restrict the tests to those specific files only.

Additionally, any other [Vitest CLI options](https://jest.dev/guide/cli.html) can be used as passthrough arguments as well after an argument separator (two dashes `--`).

| Option             | Type      | Description                                                                                                                                                                 |
| ------------------ | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--affected`       | `boolean` | Select all affected Workspaces. If no other inputs are chosen, this will default to `true`.                                                                                 |
| `--all, -a`        | `boolean` | Run across all workspaces                                                                                                                                                   |
| `--inspect`        | `boolean` | Break for the the Node inspector to debug tests.                                                                                                                            |
| `--show-advanced`  | `boolean` | Pair with `--help` to show advanced options.                                                                                                                                |
| `--staged`         | `boolean` | Use files on the git stage to calculate affected files or Workspaces. When unset or `--no-staged`, changes will be calculated from the entire branch, since its fork point. |
| `--watch`          | `boolean` | Shortcut for vitest `--watch` mode.                                                                                                                                         |
| `--workspaces, -w` | `array`   | List of Workspace names to run against                                                                                                                                      |

<details>

<summary>Advanced options</summary>

| Option          | Type                                      | Description                                                |
| --------------- | ----------------------------------------- | ---------------------------------------------------------- |
| `--config`      | `string`, default: `"./vitest.config.ts"` | Path to the vitest.config file, relative to the repo root. |
| `--from-ref`    | `string`                                  | Git ref to start looking for affected files or workspaces  |
| `--through-ref` | `string`                                  | Git ref to start looking for affected files or workspaces  |

</details>

Run only tests related to modified files.

```sh
one test
```

Run vitest in --watch mode.

```sh
one test --watch
```

Run vitest in watch mode with a particular file.

```sh
one test --watch -- path/to/test.ts
```

Run all tests in a given Workspace.

```sh
one test -w <workspace>
```

{/* end-auto-generated-from-cli-vitest */}
