---
title: '@onerepo/plugin-changesets'
description: Official Changesets plugin for the oneRepo JavaScript and TypeScript monorepo toolchain.
sidebar:
  label: Changesets
meta:
  version: 1.0.0-beta.1
  stability: deprecated
---

import { TabItem } from '@astrojs/starlight/components';
import Tabs from '../../../components/Tabs.astro';

[Changesets](https://github.com/changesets/changesets) are a way to manage versioning and changelogs in monorepos.

:::danger[Deprecated]
This plugin is deprecated in favor of the built-in [change management](/core/changes/). Remove this plugin and run `one change migrate` to get started.
:::

## Installation

<Tabs group="pkgmanager">
  <TabItem label="npm">

    ```sh title="Install via npm"
    npm install --save-dev @onerepo/plugin-changesets
    ```

  </TabItem>
  <TabItem label="yarn">

    ```sh title="Install via Yarn"
    yarn add --dev @onerepo/plugin-changesets
    ```

  </TabItem>
  <TabItem label="pnpm">

    ```sh title="Install via pnpm"
    pnpm install --save-dev @onerepo/plugin-changesets
    ```

  </TabItem>
</Tabs>

{/* start-install-typedoc */}
{/* @generated SignedSource<<65a3f873a9856957e09cf301ea3c1c07>> */}

### changesets()

```ts
changesets(opts): Plugin
```

Include the `changesets` plugin in your oneRepo plugin setup:

```ts title="onerepo.config.ts" {1,4}
import { changesets } from '@onerepo/plugin-changesets';

export default {
	plugins: [changesets()],
};
```

#### Parameters

| Parameter | Type                  |
| :-------- | :-------------------- |
| `opts`    | [`Options`](#options) |

### Options

```ts
type Options: {
  name: string | string[];
};
```

```ts title="onerepo.config.ts"
import { changesets } from '@onerepo/plugin-changesets';

export default {
	plugins: [
		changesets({
			name: ['change'],
		}),
	],
};
```

#### Type declaration

##### name?

```ts
optional name: string | string[];
```

{/* end-install-typedoc */}

## Commands

{/* start-auto-generated-from-cli-changesets */}
{/* @generated SignedSource<<1df8ed93a5898104236831bc7963931c>> */}

### `one change`

Aliases: `one changes`, `one changesets`

Manage changes and changesets for publishable workspaces.

```sh
one change <command>
```

---

#### `one change add`

Aliases: `one change`

Add changesets for modified Workspaces.

```sh
one change add [options...]
```

This command will prompt for appropriate Workspace(s), prompt for the release type, and request a descriptive change entry. Once all information has been entered, a change entry file will be created in the appropriate Workspace(s). Be sure to commit these files – they will be used later when you are ready to version and publish Workspaces to the registry for use outside of the Monorepo.

| Option             | Type                            | Description                                                                                                         |
| ------------------ | ------------------------------- | ------------------------------------------------------------------------------------------------------------------- |
| `--add`            | `boolean`, default: `true`      | Add the modified `package.json` files to the git stage for committing.                                              |
| `--affected`       | `boolean`                       | Select all affected Workspaces. If no other inputs are chosen, this will default to `true`.                         |
| `--all, -a`        | `boolean`                       | Run across all workspaces                                                                                           |
| `--type`           | `"major"`, `"minor"`, `"patch"` | Provide a semantic version bump type. If not given, a prompt will guide you through selecting the appropriate type. |
| `--workspaces, -w` | `array`                         | List of Workspace names to run against                                                                              |

<details>

<summary>Advanced options</summary>

| Option          | Type                                        | Description                                                                                                                                                                 |
| --------------- | ------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--filenames`   | `"hash"`, `"human"`, default: `"human"`     | Filename generation strategy for change files. If `'human'`, ensure you have the `human-id` package installed.                                                              |
| `--from-ref`    | `string`                                    | Git ref to start looking for affected files or workspaces                                                                                                                   |
| `--prompts`     | `"guided"`, `"semver"`, default: `"guided"` | Change the prompt question & answer style when adding change entries.                                                                                                       |
| `--staged`      | `boolean`                                   | Use files on the git stage to calculate affected files or Workspaces. When unset or `--no-staged`, changes will be calculated from the entire branch, since its fork point. |
| `--through-ref` | `string`                                    | Git ref to start looking for affected files or workspaces                                                                                                                   |

</details>

---

#### `one change migrate`

Migrate from Changesets to oneRepo changes.

```sh
one change migrate
```

<details>

<summary>Advanced options</summary>

| Option        | Type                                    | Description                                                                                                    |
| ------------- | --------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| `--filenames` | `"hash"`, `"human"`, default: `"human"` | Filename generation strategy for change files. If `'human'`, ensure you have the `human-id` package installed. |

</details>

---

#### `one change publish`

Aliases: `one change release`

Publish all Workspaces with versions not available in the registry.

```sh
one change publish [options...]
```

This command is safe to run any time. By default, only Workspaces that have previously gone through the `one change version` process will end up being published. Use `--all` for all Workspaces or `--workspaces <workspace-name>` to specify individual Workspaces to try publishing.

For each Workspace, the registry will be queried first to ensure the current version in the Workspace does not yet exist in the registry. If a version _does_ exist, the Workspace will be skipped.

| Option             | Type      | Description                                                                                |
| ------------------ | --------- | ------------------------------------------------------------------------------------------ |
| `--all, -a`        | `boolean` | Run across all workspaces                                                                  |
| `--otp`            | `boolean` | Set to true if your publishes require an OTP for NPM.                                      |
| `--skip-auth`      | `boolean` | Skip auth checks. This may be necessary for some internal registries using PATs or tokens. |
| `--workspaces, -w` | `array`   | List of Workspace names to run against                                                     |

<details>

<summary>Advanced options</summary>

| Option          | Type      | Description                                                                                                                                                                 |
| --------------- | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--affected`    | `boolean` | Select all affected Workspaces. If no other inputs are chosen, this will default to `true`.                                                                                 |
| `--allow-dirty` | `boolean` | Bypass checks to ensure no there are no un-committed changes.                                                                                                               |
| `--from-ref`    | `string`  | Git ref to start looking for affected files or workspaces                                                                                                                   |
| `--staged`      | `boolean` | Use files on the git stage to calculate affected files or Workspaces. When unset or `--no-staged`, changes will be calculated from the entire branch, since its fork point. |
| `--through-ref` | `string`  | Git ref to start looking for affected files or workspaces                                                                                                                   |

</details>

Publish the `api` Workspace and its dependencies, if necessary.

```sh
one change publish -w api
```

Attempt to publish _all_ non-private Workspaces.

```sh
one change publish --all
```

---

#### `one change snapshot`

Aliases: `one change snap`

Publish a snapshot pre-release.

```sh
one change snapshot
```

Periodically you may want to publish a _snapshot_ release – something that needs testing from the registry, but should not update the current version nor be made widely available. For these cases, use `--snapshot` and versions will be published in the format `0.0.0-{tag}-{hash}`, where `{hash}` is a short version of the current git sha. By appending a prerelease to version `0.0.0`, discoverability is greatly reduced.

| Option             | Type                              | Description                                                               |
| ------------------ | --------------------------------- | ------------------------------------------------------------------------- |
| `--all, -a`        | `boolean`                         | Run across all workspaces                                                 |
| `--allow-dirty`    | `boolean`                         | Bypass checks to ensure no there are no un-committed changes.             |
| `--otp`            | `boolean`                         | Prompt for one-time password before publishing to the registry            |
| `--reset`          | `boolean`, default: `true`        | Reset `package.json` changes before exiting. Use `--no-reset` to disable. |
| `--tag`            | `string`, default: `"prerelease"` | Distribution tag to apply when publishing the pre-release.                |
| `--workspaces, -w` | `array`                           | List of Workspace names to run against                                    |

---

#### `one change verify`

Aliases: `one change required`

Ensure there are change entries for every modified public Workspace.

```sh
one change verify
```

Add this to your pre-commit or pre-merge task lifecycles to ensure that changes to public & publishabled Workspaces are always accompanied with change entries.

---

#### `one change version`

Update version numbers for publishable workspaces

```sh
one change version
```

| Option                               | Type      | Description                                                   |
| ------------------------------------ | --------- | ------------------------------------------------------------- |
| `--all, -a`                          | `boolean` | Run across all workspaces                                     |
| `--allow-dirty`                      | `boolean` | Bypass checks to ensure no there are no un-committed changes. |
| `--prerelease, --pre, --pre-release` | `string`  | Create a pre-release using the specified identifier.          |
| `--workspaces, -w`                   | `array`   | List of Workspace names to run against                        |

Create a prerelease for the next version the form of `1.2.3-alpha.0`.

```sh
one change version --prerelease=alpha
```

{/* end-auto-generated-from-cli-changesets */}
